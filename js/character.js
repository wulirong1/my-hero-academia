const cardData = {
    "綠谷出久": { bg: "img/background/A/deku.png", char: "img/characters/A/deku.png" },
    "爆豪勝己": { bg: "img/background/A/boom.png", char: "img/characters/A/bakugo.png" },
    "轟焦凍": { bg: "img/background/A/shoto.png", char: "img/characters/A/todoloki.png" },
    "八百萬百": { bg: "img/background/A/momo.png", char: "img/characters/A/yaoyorozu.png", pos: "-20%" },
    "麗日御茶子": { bg: "img/background/A/ochaku.png", char: "img/characters/A/ochako.png" },
    "飯田天哉": { bg: "img/background/A/rice.png", char: "img/characters/A/tenya.png" },
    "葉隱透": { bg: "img/background/A/toru.png", char: "img/characters/A/hagakule.png" },
    "障子目藏": { bg: "img/background/A/mezo.png", char: "img/characters/A/shoji.png" },
    "尾白猿夫": { bg: "img/background/A/ojiro.png", char: "img/characters/A/ojilo.png", size: "80%" },
    "青山優雅": { bg: "img/background/A/yuga.png", char: "img/characters/A/aoyama.png", pos: "0%" },
    "耳郎響香": { bg: "img/background/A/kyoka.png", char: "img/characters/A/kyoka.png" },
    "上鳴電氣": { bg: "img/background/A/denki.png", char: "img/characters/A/kamilani.png", size: "170%", pos: "-30%", tabletSize: "130%", tabletPos: "-40%" },
    "蘆戶三奈": { bg: "img/background/A/mina.png", char: "img/characters/A/ashido.png" },
    "瀨呂範太": { bg: "img/background/A/tape.png", char: "img/characters/A/sero.png", pos: "0%" },
    "切島銳兒郎": { bg: "img/background/A/eijiro.png", char: "img/characters/A/kilishima.png" },
    "蛙吹梅雨": { bg: "img/background/A/frog.png", char: "img/characters/A/tsuyu.png" },
    "峰田實": { bg: "img/background/A/grape.png", char: "img/characters/A/mineta.png", size: "50%" },
    "常闇踏陰": { bg: "img/background/A/dark.png", char: "img/characters/A/tokoyami.png" },
    "口田甲司": { bg: "img/background/A/koji.png", char: "img/characters/A/koda.png" },
    "砂藤力道": { bg: "img/background/A/sato.png", char: "img/characters/A/sato.png", size: "105%" },

    "死柄木弔": {
        bg: "img/background/enimy/hand.png",
        char: "img/characters/ENIMY/tomura.png",
        pos: "-5%" 
    },
    "渡我被身子": { bg: "img/background/enimy/toga.png", char: "img/characters/ENIMY/toga himiko.png" },
    "黑霧": { bg: "img/background/enimy/kuro.png", char: "img/characters/ENIMY/kurogili.png", size: "130%" },
    "荼毘": { bg: "img/background/enimy/dabi.png", char: "img/characters/ENIMY/dabi.png" },
    "雙倍": { bg: "img/background/enimy/TWICE.png", char: "img/characters/ENIMY/twice.png" },
    "壓縮先生": { bg: "img/background/enimy/compress.png", char: "img/characters/ENIMY/mr.compress.png" },
    "編織者": { bg: "img/background/enimy/spin.png", char: "img/characters/ENIMY/spin.png" },
    "AFO": { bg: "img/background/enimy/AFO.png", char: "img/characters/ENIMY/AFO.png" },

    "歐爾麥特": {
        bg: "img/background/hero/allmight.png",
        char: "img/characters/HERO/allmight.png",
        size: "85%" 
    },
    "安德瓦": { bg: "img/background/hero/fire.png", char: "img/characters/HERO/endeavor.png" },
    "霍克斯": { bg: "img/background/hero/bird.png", char: "img/characters/HERO/hawks.png"},
    "最佳牛仔褲時尚名人": { bg: "img/background/hero/jeans.png", char: "img/characters/HERO/jeans.png", pos: "-35%" },
    "暴力虎鯨": { bg: "img/background/V/shigaraki.png", char: "img/characters/HERO/gang orca.png" },
    "夜目爵士": { bg: "img/background/hero/eye.png", char: "img/characters/HERO/sir nighteye.png" },
    "紙鋒射手": { bg: "img/background/hero/ninjia.png", char: "img/characters/HERO/edgeshot.png" },
    "S&S": { bg: "img/background/V/shigaraki.png", char: "img/characters/HERO/star.png", size: "600%" },
    "經典老爺車": { bg: "img/background/hero/old.png", char: "img/characters/HERO/gran torino.png" },
    "龍九": { bg: "img/background/V/shigaraki.png", char: "img/characters/HERO/ryukyu.png" },
    "肥膠": { bg: "img/background/hero/fat.png", char: "img/characters/HERO/fat gum.png" },

    // === 學校人士 ===
    "根津校長": { bg: "img/background/school/nezu.png", char: "img/characters/SCHOOL/nezu.png", size: "50%" },
    "相澤消太": { bg: "img/background/school/eraser.png", char: "img/characters/SCHOOL/eraser head.png" },
    "禮物麥克風": { bg: "img/background/school/mic.png", char: "img/characters/SCHOOL/present mic.png" },
    "物間寧人": { bg: "img/background/V/shigaraki.png", char: "img/characters/SCHOOL/neito.png" },
    "心操人使": { bg: "img/background/school/shinso.png", char: "img/characters/SCHOOL/shinso.png" },
    "通行百萬": { bg: "img/background/school/mirio.png", char: "img/characters/SCHOOL/MIRIO.png" },
    "天喰環": { bg: "img/background/school/tamaki.png", char: "img/characters/SCHOOL/tamaki.png",  pos: "-30%" },
    "波動螺卷": { bg: "img/background/school/hado.png", char: "img/characters/SCHOOL/hado.png" },
};

function setupSection(namesArray, gridId, bgId, charId, backId) { 
    const grid = document.getElementById(gridId);
    const bgImg = document.getElementById(bgId);
    const charImg = document.getElementById(charId);
    const backImg = document.getElementById(backId); // 抓取卡背

    if (!grid || !bgImg || !charImg || !backImg) return;

    function performSwitch(name) {
        backImg.classList.add('flipped');
        charImg.classList.remove('show-anim');
        charImg.style.opacity = '0';
        charImg.style.width = '';
        charImg.style.right = '';
        const screenWidth = window.innerWidth;
        const isTablet = screenWidth <= 1200 && screenWidth > 768;
        const isMobile = screenWidth <= 768;
        setTimeout(() => {
            const data = cardData[name] || { bg: "img/default-bg.jpg", char: "img/default-char.png" };
            bgImg.src = data.bg;
            charImg.src = data.char;

            let finalSize = data.size;
            if (isTablet && data.tabletSize) finalSize = data.tabletSize;
            if (isMobile && data.mobileSize) finalSize = data.mobileSize;

            let finalPos = data.pos;
            if (isTablet && data.tabletPos) finalPos = data.tabletPos;
            if (isMobile && data.mobilePos) finalPos = data.mobilePos;

            if (finalSize) {
                charImg.style.width = finalSize;
                charImg.style.height = 'auto'; 
            } else {
                charImg.style.width = '';
                charImg.style.height = ''; 
            }

            if (finalPos) {
                charImg.style.right = finalPos;
            } else {
                charImg.style.right = '';
            }

            setTimeout(() => {
                charImg.style.opacity = '1';
                charImg.classList.add('show-anim');
            }, 100);
        }, 50);
    }

    backImg.onclick = () => {
        if (backId === 'back-layer-A') {
            const handHint = document.querySelector('.click-hint-hand');
            if (handHint) {
                handHint.style.display = 'none';
            }
        }
        if (namesArray.length > 0) {
            performSwitch(namesArray[0]); 
        }
    };

    namesArray.forEach(name => {
        const div = document.createElement('div');
        div.className = 'name-btn';
        div.innerText = name;
        div.onclick = () => {
            if (backId === 'back-layer-A') {
                const handHint = document.querySelector('.click-hint-hand');
                if (handHint) handHint.style.display = 'none';
            }
            performSwitch(name); 
        };
        grid.appendChild(div);
    });
}

setupSection(
    ["葉隱透", "障子目藏", "尾白猿夫", "青山優雅", "爆豪勝己", "耳郎響香", "上鳴電氣", "蘆戶三奈", "綠谷出久", "瀨呂範太", "切島銳兒郎", "蛙吹梅雨", "峰田實", "常闇踏陰", "口田甲司", "飯田天哉", "八百萬百", "轟焦凍", "砂藤力道", "麗日御茶子"],
    'name-grid', 'bg-layer', 'char-layer', 'back-layer-A'
);

setupSection(
    ["死柄木弔", "黑霧", "荼毘", "渡我被身子", "雙倍", "壓縮先生", "編織者", "AFO"],
    'grid-villain', 'bg-layer-villain', 'char-layer-villain', 'back-layer-villain'
);

setupSection(
    ["歐爾麥特", "安德瓦", "霍克斯", "最佳牛仔褲時尚名人", "夜目爵士", "紙鋒射手", "經典老爺車", "肥膠"],
    'grid-hero', 'bg-layer-hero', 'char-layer-hero', 'back-layer-hero'
);

setupSection(
    ["根津校長", "相澤消太", "禮物麥克風", "心操人使", "通行百萬", "天喰環", "波動螺卷"],
    'grid-staff', 'bg-layer-staff', 'char-layer-staff', 'back-layer-staff'
);

document.addEventListener('DOMContentLoaded', function () {
    const menu = document.querySelector('#mobile-menu');
    const nav = document.querySelector('.nav-links');
    if (menu) {
        menu.onclick = function () {
            menu.classList.toggle('active');
            nav.classList.toggle('show');
        };
    }
});